local_costmap:
  ros__parameters:
    update_frequency: 5.0
    publish_frequency: 2.0
    global_frame: odom
    robot_base_frame: base_link
    use_sim_time: True
    rolling_window: true
    width: 10
    height: 10
    origin_x: -5
    origin_y: -5
    resolution: 0.05
    footprint: "[ [0.21, 0.195], [0.21, -0.195], [-0.21, -0.195], [-0.21, 0.195] ]"
    plugins: ["voxel_layer", "inflation_layer"]
    inflation_layer:
      plugin: "nav2_costmap_2d::InflationLayer"
      cost_scaling_factor: 3.0
      inflation_radius: 0.55
    voxel_layer:
      plugin: "nav2_costmap_2d::VoxelLayer"
      enabled: True
      publish_voxel_map: True
      origin_z: 0.0
      z_resolution: 0.05
      z_voxels: 16
      max_obstacle_height: 2.0
      mark_threshold: 0
      observation_sources: pointcloud
      pointcloud:
        topic: /depth_camera/points
        data_type: "PointCloud2"
    static_layer:
      map_subscribe_transient_local: True
    always_send_full_costmap: True
local_costmap_client:
  ros__parameters:
    use_sim_time: True
local_costmap_rclcpp_node:
  ros__parameters:
    use_sim_time: True

global_costmap:
  ros__parameters:
    update_frequency: 1.0
    publish_frequency: 1.0
    global_frame: map
    robot_base_frame: base_link
    use_sim_time: True
    robot_radius: 0.3
    resolution: 0.05
    track_unknown_space: true
    plugins: ["static_layer", "obstacle_layer", "inflation_layer"]
    obstacle_layer:
      plugin: "nav2_costmap_2d::ObstacleLayer"
      enabled: True
      observation_sources: pointcloud 
      pointcloud:
        topic: /depth_camera/points
        data_type: "PointCloud2"
    static_layer:
      plugin: "nav2_costmap_2d::StaticLayer"
      map_subscribe_transient_local: True
    inflation_layer:
      plugin: "nav2_costmap_2d::InflationLayer"
      cost_scaling_factor: 3.0
      inflation_radius: 0.55
    always_send_full_costmap: True
global_costmap_client:
  ros__parameters:
    use_sim_time: True
global_costmap_rclcpp_node:
  ros__parameters:
    use_sim_time: True

    
controller_server:
  ros__parameters:
    controller_plugins: ["FollowPath"]
    FollowPath:
      plugin: "dwb_core::DWBLocalPlanner"
      max_vel_x: 0.5          # Max forward speed (m/s)
      min_vel_x: 0.1          # Min forward speed (m/s)
      path_distance_bias: 32.0 # Stay on path vs avoid obstacles
      goal_distance_bias: 20.0
      costmap_weight_obstacle: 0.8

behavior_server:
  ros__parameters:
    behavior_plugins: ["Forward"]
    Forward:
      plugin: "nav2_behaviors::Forward"
      forward_velocity: 0.3
      max_forward_distance: 1.0

bt_navigator:
  ros__parameters:
    default_bt_xml_filename: "$(find slam)/config/bt.xml"
